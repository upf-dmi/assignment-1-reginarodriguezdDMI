install.packages(c("readxl","dplyr","ggplot2","kableExtra","tidyr"))
list.files("data/")  # Table_S1.xlsx sale?
install.packages(c("readxl", "readr", "dplyr", "tidyr", "ggplot2", "kableExtra", "scales"))
---
title: "Hands On-1"
install.packages(c("corrplot", "summarytools", "visdat"))
install readr
install.packages(c("readr", "dplyr", "knitr", "kableExtra", "ggplot2", "summarytools", "visdat", "corrplot"))
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication.
data <- read_csv("data/Table_S1.csv")
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication.
data <- read_csv("data/Table_S1")
# View structure and summary
str(data)
summary(data)
## Exercise 1.1
Reproduce Table 1 from the manuscript using the supplementary data. Match the reported summary statistics   as closely as possible.
Briefly discuss any discrepancies between your results and the published table, and provide possible explanations.
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
## Exercise 1.2
Perform an exploratory data analysis (EDA) of the dataset. At a minimum, include:
```{r setup, include=FALSE}
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(visdat)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(visdat)
This practical focuses on data wrangling, exploratory data analysis, visualization, and critical comparison with published results using real biomedical data.
We will work with the publication [**Proteomic and Metabolomic Characterization of COVID-19 Patient Sera**](https://www.sciencedirect.com/science/article/pii/S0092867420306279)
# Exercise 1
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication.
data <- read_csv("data/Table_S1")
getwd()
list.files(".", all.files = TRUE)
list.files("data")
head(data)
colnames(data)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(visdat)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(visdat)
#This practical focuses on data wrangling, exploratory data analysis, visualization, and critical comparison with published results using real biomedical data.
#We will work with the publication [**Proteomic and Metabolomic Characterization of COVID-19 Patient #Sera**]#(https://www.sciencedirect.com/science/article/pii/S0092867420306279)
# Exercise 1
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication.
data <- read_csv("data/Table_S1.xlsx - Clinical_information.csv")
# View structure and summary
str(data)
summary(data)
## Exercise 1.1
#Reproduce Table 1 from the manuscript using the supplementary data. Match the reported summary statistics   as closely as possible.
#Briefly discuss any discrepancies between your results and the published table, and provide possible explanations.
```{r}
table1 <- data %>%
group_by(Group) %>%  # Change 'Group' to your actual group column
summarise(
across(where(is.numeric), list(
Mean = ~round(mean(., na.rm = TRUE), 1),
SD = ~round(sd(., na.rm = TRUE), 1),
N = ~sum(!is.na(.))
), .names = "{.col}_{.fn}"),
across(where(is.character) | where(is.factor),
list(N = ~n(), Pct = ~round(mean(. == unique(.)[1]) * 100, 1)),  # Adjust for specific categories
.names = "{.col}_{.fn}"),
.groups = "drop"
) %>%
select(starts_with(c("Age", "Sex", "BMI", "Group")))  # Select relevant columns
kable(table1, caption = "Reproduced Table 1: Summary Statistics by Group", digits = 1) %>%
kable_styling()
kable(table1, caption = "Reproduced Table 1: Summary Statistics by Group", digits = 1) %>%
kable_styling()
## Exercise 1.2
#Perform an exploratory data analysis (EDA) of the dataset. At a minimum, include:
#- Descriptive statistics for key variables
#- Appropriate visualizations (e.g. distributions, group comparisons)
#- A brief written summary of notable patterns, anomalies, or data quality issues
```{r}
## Exercise 1.2: EDA
# Descriptivos
dfSummary(data)
## Exercise 1.2: EDA
# Descriptivos
dfSummary(data)
# Missing values
vis_miss(data)
# Univariate: Histograms/Density/Boxplots for key vars (Age, BMI, etc.)
ggplot(data, aes(x = Age)) +  # Replace Age with key var
geom_histogram(aes(y = after_stat(density)), bins = 20, alpha = 0.7, fill = "steelblue") +
geom_density(color = "red") +
labs(title = "Distribution of Age", x = "Age (years)", y = "Density") +
theme_minimal()
data$Group <- as.factor(data$`Group d`)
table1 <- data %>%
group_by(Group) %>%
summarise(
across(where(is.numeric),
list(
Mean = ~round(mean(.x, na.rm=TRUE), 1),
SD = ~round(sd(.x, na.rm=TRUE), 1),
N = ~sum(!is.na(.x))
), .names = "{.col}_{.fn}"),
across(c(`Sex g`),
list(N_Male = ~sum(.x == 1, na.rm=TRUE),
N_Female = ~sum(.x == 0, na.rm=TRUE))),
`Age year_mean` = round(mean(`Age year`, na.rm=TRUE),1),
`Age year_sd` = round(sd(`Age year`, na.rm=TRUE),1),
.groups = "drop"
) %>%
select(Group, starts_with("Sex"), starts_with("Age"), everything()) %>%
rename("N" = contains("_N"))
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(visdat)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(visdat)
#This practical focuses on data wrangling, exploratory data analysis, visualization, and critical comparison with published results using real biomedical data.
#We will work with the publication [**Proteomic and Metabolomic Characterization of COVID-19 Patient #Sera**]\#(<https://www.sciencedirect.com/science/article/pii/S0092867420306279>)
# Exercise 1
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication. data \<-
```
# View structure and summary
str(data) summary(data)
## Exercise 1.1
#Reproduce Table 1 from the manuscript using the supplementary data. Match the reported summary statistics as closely as possible.
#Briefly discuss any discrepancies between your results and the published table, and provide possible explanations.
```{r}
table1 <- data %>%
group_by(Group) %>%  # Change 'Group' to your actual group column
summarise(
across(where(is.numeric), list(
Mean = ~round(mean(., na.rm = TRUE), 1),
SD = ~round(sd(., na.rm = TRUE), 1),
N = ~sum(!is.na(.))
), .names = "{.col}_{.fn}"),
across(where(is.character) | where(is.factor),
list(N = ~n(), Pct = ~round(mean(. == unique(.)[1]) * 100, 1)),  # Adjust for specific categories
.names = "{.col}_{.fn}"),
.groups = "drop"
) %>%
select(starts_with(c("Age", "Sex", "BMI", "Group")))  # Select relevant columns
kable(table1, caption = "Reproduced Table 1: Summary Statistics by Group", digits = 1) %>%
kable_styling()
## Exercise 1.2
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(visdat)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(visdat)
#This practical focuses on data wrangling, exploratory data analysis, visualization, and critical comparison with published results using real biomedical data.
#We will work with the publication [**Proteomic and Metabolomic Characterization of COVID-19 Patient #Sera**]\#(<https://www.sciencedirect.com/science/article/pii/S0092867420306279>)
# Exercise 1
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication. data \<-
```
# View structure and summary
str(data) summary(data)
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(dplyr)
library(knitr)
library(kableExtra)
library(summarytools)
library(visdat)
#This practical focuses on data wrangling, exploratory data analysis, visualization, and critical comparison with published results using real biomedical data.
#We will work with the publication [**Proteomic and Metabolomic Characterization of COVID-19 Patient #Sera**]\#(<https://www.sciencedirect.com/science/article/pii/S0092867420306279>)
# Exercise 1
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication. data \<-
read_csv("data/Table_S1.xlsx - Clinical_information.csv")
# View structure and summary
str(data) summary(data)
## Exercise 1.1
#Reproduce Table 1 from the manuscript using the supplementary data. Match the reported summary statistics as closely as possible.
#Briefly discuss any discrepancies between your results and the published table, and provide possible explanations.
```{r}
table1 <- data %>%
group_by(Group) %>%  # Change 'Group' to your actual group column
summarise(
across(where(is.numeric), list(
Mean = ~round(mean(., na.rm = TRUE), 1),
SD = ~round(sd(., na.rm = TRUE), 1),
N = ~sum(!is.na(.))
), .names = "{.col}_{.fn}"),
across(where(is.character) | where(is.factor),
list(N = ~n(), Pct = ~round(mean(. == unique(.)[1]) * 100, 1)),  # Adjust for specific categories
.names = "{.col}_{.fn}"),
.groups = "drop"
) %>%
select(starts_with(c("Age", "Sex", "BMI", "Group")))  # Select relevant columns
## Exercise 1.2
#Perform an exploratory data analysis (EDA) of the dataset. At a minimum, include:
#- Descriptive statistics for key variables\
#- Appropriate visualizations (e.g. distributions, group comparisons)\
#- A brief written summary of notable patterns, anomalies, or data quality issues
```{r}
## Exercise 1.2: EDA
# Descriptivos
dfSummary(data)
## Exercise 1.2: EDA
# Descriptivos
dfSummary(data)
# Missing values
vis_miss(data)
# Univariate: Histograms/Density/Boxplots for key vars (Age, BMI, etc.)
ggplot(data, aes(x = Age)) +  # Replace Age with key var
geom_histogram(aes(y = after_stat(density)), bins = 20, alpha = 0.7, fill = "steelblue") +
geom_density(color = "red") +
labs(title = "Distribution of Age", x = "Age (years)", y = "Density") +
theme_minimal()
list_files(data)
list.files("data")
names(data)
---
title: "Hands On-1"
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(summarytools)
library(visdat)
library(corrplot)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(summarytools)
library(visdat)
library(corrplot)
#This practical focuses on data wrangling, exploratory data analysis, visualization, and critical comparison with published results using real biomedical data.
#We will work with the publication [**Proteomic and Metabolomic Characterization of COVID-19 Patient #Sera**]\#(<https://www.sciencedirect.com/science/article/pii/S0092867420306279>)
# Exercise 1
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication. data \<-
read_csv("data/Table_S1. - Clinical_information.csv")
# View structure and summary
str(data)
summary(data)
#Names ofdata
data <- data %>%
rename(
Group = Group,
Sex = Sex g,
## Exercise 1.1
#Reproduce Table 1 from the manuscript using the supplementary data. Match the reported summary statistics as closely as possible.
#Briefly discuss any discrepancies between your results and the published table, and provide possible explanations.
# Check format of the variables
data <- data %>%
mutate(
Group = as.factor(Group),
Sex = as.factor(Sex)
)
# Table 1
table1 <- data %>%
group_by(Group) %>%
summarise(
across(where(is.numeric), list(
Mean = ~round(mean(., na.rm = TRUE), 1),
SD = ~round(sd(., na.rm = TRUE), 1),
N = ~sum(!is.na(.))
), .names = "{.col}_{.fn}"),
# Porcentage of women
Female_pct = round(mean(Sex == "Female", na.rm = TRUE) * 100, 1),
Total_N = n(),
.groups = "drop"
) %>%
select(Group,
starts_with("Age"),
starts_with("BMI"),
Female_pct,
Total_N)
# Show table
kable(table1,
caption = "Reproduced Table 1: Summary Statistics by Group",
digits = 1) %>%
kable_styling(full_width = FALSE)
## Exercise 1.2
#Perform an exploratory data analysis (EDA) of the dataset. At a minimum, include:
#- Descriptive statistics for key variables\
#- Appropriate visualizations (e.g. distributions, group comparisons)\
#- A brief written summary of notable patterns, anomalies, or data quality issues
dfSummary(data)
# Visualization of lost data
vis_miss(data)
# Distribution
ggplot(data, aes(x = Age)) +
geom_histogram(aes(y = after_stat(density)),
bins = 20,
alpha = 0.7,
fill = "steelblue",
na.rm = TRUE) +
geom_density(color = "red", na.rm = TRUE) +
labs(title = "Distribution of Age",
x = "Age (years)",
y = "Density") +
theme_minimal()
#Age per group
ggplot(data, aes(x = Group, y = Age)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.6, na.rm = TRUE) +
labs(title = "Age by Group",
x = "Group",
y = "Age (years)") +
theme_minimal()
#CorrelationMatrix
num_vars <- data %>% select(where(is.numeric))
cor_matrix <- cor(num_vars, use = "complete.obs")
corrplot(cor_matrix,
method = "color",
type = "upper",
order = "hclust")
# BMI per grou´p
ggplot(data, aes(x = Group, y = BMI)) +
geom_violin(alpha = 0.7, na.rm = TRUE) +
geom_boxplot(width = 0.2, fill = "white", na.rm = TRUE) +
labs(title = "BMI Distribution by Group",
x = "Group",
y = "BMI") +
theme_minimal()
# Exercise 2
# Distribution
ggplot(data, aes(x = Age)) +
geom_histogram(aes(y = after_stat(density)),
bins = 20,
alpha = 0.7,
fill = "steelblue",
na.rm = TRUE) +
geom_density(color = "red", na.rm = TRUE) +
labs(title = "Distribution of Age",
x = "Age (years)",
y = "Density") +
theme_minimal()
#Age per group
ggplot(data, aes(x = Group, y = Age)) +
geom_boxplot() +
geom_jitter(width = 0.2, alpha = 0.6, na.rm = TRUE) +
labs(title = "Age by Group",
x = "Group",
y = "Age (years)") +
theme_minimal()
#CorrelationMatrix
num_vars <- data %>% select(where(is.numeric))
cor_matrix <- cor(num_vars, use = "complete.obs")
corrplot(cor_matrix,
method = "color",
type = "upper",
order = "hclust")
# BMI per grou´p
ggplot(data, aes(x = Group, y = BMI)) +
geom_violin(alpha = 0.7, na.rm = TRUE) +
geom_boxplot(width = 0.2, fill = "white", na.rm = TRUE) +
labs(title = "BMI Distribution by Group",
x = "Group",
y = "BMI") +
theme_minimal()
---
title: "Hands On-1"
#This practical focuses on data wrangling, exploratory data analysis, visualization, and critical comparison with published results using real biomedical data.
#We will work with the publication [**Proteomic and Metabolomic Characterization of COVID-19 Patient #Sera**]\#(<https://www.sciencedirect.com/science/article/pii/S0092867420306279>)
# Exercise 1
#Download and load Supplementary Table 1 (“Additional Demographical and Baseline Characteristics of COVID-19 Patients and Control Groups”) from the supplementary materials of the publication. data \<-
read_csv("data/Table_S1. - Clinical_information.csv")
# View structure and summary
str(data)
summary(data)
#Names ofdata
data <- data %>%
rename(
Group = Group,
Sex = Sex g,
## Exercise 1.1
#Reproduce Table 1 from the manuscript using the supplementary data. Match the reported summary statistics as closely as possible.
#Briefly discuss any discrepancies between your results and the published table, and provide possible explanations.
# Check format of the variables
data <- data %>%
mutate(
Group = as.factor(Group),
Sex = as.factor(Sex)
)
# Table 1
table1 <- data %>%
group_by(Group) %>%
summarise(
across(where(is.numeric), list(
Mean = ~round(mean(., na.rm = TRUE), 1),
SD = ~round(sd(., na.rm = TRUE), 1),
N = ~sum(!is.na(.))
), .names = "{.col}_{.fn}"),
# Porcentage of women
Female_pct = round(mean(Sex == "Female", na.rm = TRUE) * 100, 1),
Total_N = n(),
.groups = "drop"
) %>%
select(Group,
starts_with("Age"),
starts_with("BMI"),
Female_pct,
Total_N)
# Show table
kable(table1,
caption = "Reproduced Table 1: Summary Statistics by Group",
digits = 1) %>%
kable_styling(full_width = FALSE)
## Exercise 1.2
names(data)
